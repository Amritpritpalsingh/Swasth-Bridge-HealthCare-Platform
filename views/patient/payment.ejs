<%- layout("layouts/mainPat.ejs") %>

<main class="container py-5 text-center">
  <div class="card shadow-sm mx-auto" style="max-width: 420px;">
    <div class="card-body">
      <h4 class="mb-3">ðŸ’³ Payment for Report</h4>
      <p class="text-muted">Please confirm your payment to download your medical report.</p>

      <h3 id="amountDisplay" class="text-success fw-bold mb-4">â‚¹<%= appointment.payment.amount || 0 %></h3>

      <div id="paymentInfo" class="d-none">
        <% if (appointment.doctor?.upiId) { %>
          <p><strong>UPI ID:</strong> <%= appointment.doctor.upiId %></p>
        <% } %>
        <% if (qrCodeUrl) { %>
          <img src="<%= qrCodeUrl %>" alt="QR Code" class="img-fluid mb-3">
        <% } %>
        <p>After payment, upload the screenshot and click "I Paid" to confirm.</p>

        <!-- Screenshot Upload -->
        <input type="file" id="paymentScreenshot" accept="image/*" class="form-control mb-3">
        <input type="text" id="transactionId" placeholder="Enter Txn ID" class="form-control mb-3">
      </div>

      <div id="paymentButtons">
        <button id="showQRBtn" type="button" class="btn btn-primary w-100 mb-2">Pay Now</button>
        <button id="confirmPayBtn" type="button" class="btn btn-success w-100 d-none">I Paid</button>
        <a href="/sb/pat/dashboard" class="btn btn-outline-secondary w-100 mt-2">Cancel</a>
      </div>

      <input type="hidden" id="appointmentId" value="<%= appointment._id %>">
    </div>
  </div>
</main>
